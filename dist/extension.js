"use strict";var L=Object.create;var p=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var O=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var h=e=>o=>{var t=e[o];if(t)return t();throw new Error("Module not found in bundle: "+o)};var w=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports),E=(e,o)=>{for(var t in o)p(e,t,{get:o[t],enumerable:!0})},T=(e,o,t,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of N(o))!$.call(e,s)&&s!==t&&p(e,s,{get:()=>o[s],enumerable:!(i=S(o,s))||i.enumerable});return e};var m=(e,o,t)=>(t=e!=null?L(O(e)):{},T(o||!e||!e.__esModule?p(t,"default",{value:e,enumerable:!0}):t,e)),A=e=>T(p({},"__esModule",{value:!0}),e);var C=w((F,U)=>{U.exports={"notification.confirmationRequired":"Confirma\xE7\xE3o Necess\xE1ria","button.respond":"Responder","input.placeholder":"Digite sua resposta aqui..."}});var R=w((K,_)=>{_.exports={"notification.confirmationRequired":"Confirmation Required","button.respond":"Respond","input.placeholder":"Type your response here..."}});var H={};E(H,{activate:()=>B,deactivate:()=>D});module.exports=A(H);var n=m(require("vscode"));var r=m(require("vscode"));var x=m(require("vscode"));var J=h({"../package.nls.pt-br.json":()=>C()});var k=JSON.parse(JSON.stringify(R()));try{let e=x.env.language;if(e&&e!=="en"){let o=J(`../package.nls.${e}.json`);Object.assign(k,o)}}catch{}function f(e,...o){let t=k[e]||e;return o.forEach((i,s)=>{t=t.replace(`{${s}}`,String(i))}),t}var g={get confirmationRequired(){return f("notification.confirmationRequired")},get respond(){return f("button.respond")},get inputPlaceholder(){return f("input.placeholder")}};function q(e){let o=r.lm.registerTool("ask_user",{async invoke(t,i){let s=t.input,c=s.question,u=s.title||"Confirmation Required",d=await Y(c,u);return new r.LanguageModelToolResult([new r.LanguageModelTextPart(JSON.stringify({responded:d.responded,response:d.response}))])}});e.subscriptions.push(o)}async function Y(e,o){let t=g.respond;if(await r.commands.executeCommand("workbench.action.focusActiveEditorGroup"),await r.window.showWarningMessage(`${g.confirmationRequired}: ${e}`,{modal:!1},t)!==t)return{responded:!1,response:""};let s=await r.window.showInputBox({title:o,prompt:e,placeHolder:g.inputPlaceholder,ignoreFocusOut:!0});return s===void 0?{responded:!1,response:""}:{responded:s.trim().length>0,response:s}}var z="seamless-agent.agent";function B(e){console.log("Seamless Agent extension active"),q(e);let o=async(i,s,c,u)=>{let d=n.lm.tools.find(a=>a.name==="ask_user"),M=d?[d]:[],P=[n.LanguageModelChatMessage.User(`You are a helpful assistant. 
IMPORTANT: You have access to an "ask_user" tool. You MUST use this tool before completing any task to confirm with the user that their request was fulfilled correctly.
Never finish a response without first calling the ask_user tool to verify with the user.`),n.LanguageModelChatMessage.User(i.prompt)],y=i.model,b={tools:M.map(a=>({name:a.name,description:a.description,inputSchema:a.inputSchema}))};try{let a=await y.sendRequest(P,b,u);for await(let l of a.stream)if(l instanceof n.LanguageModelTextPart)c.markdown(l.value);else if(l instanceof n.LanguageModelToolCallPart){c.progress(`Calling ${l.name}...`);let I=await n.lm.invokeTool(l.name,{input:l.input,toolInvocationToken:i.toolInvocationToken},u);for(let v of I.content)v instanceof n.LanguageModelTextPart&&c.markdown(`

**User Response:** ${v.value}

`)}}catch(a){if(a instanceof n.LanguageModelError)c.markdown(`Error: ${a.message}`);else throw a}},t=n.chat.createChatParticipant(z,o);t.iconPath=new n.ThemeIcon("question"),e.subscriptions.push(t)}function D(){}0&&(module.exports={activate,deactivate});
